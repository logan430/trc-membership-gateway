---
phase: 12-route-restructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/routes/public.ts
  - public/index.html
  - public/login.html
  - public/signup.html
  - public/dashboard.html
  - public/claim.html
  - public/team-dashboard.html
  - public/checkout-success.html
autonomous: true

must_haves:
  truths:
    - "User can access signup page at /app/auth/signup"
    - "User can access login page at /app/auth/login"
    - "Old auth routes (/auth/signup, /auth/login) return 404"
    - "All internal links point to new /app/auth/* paths"
  artifacts:
    - path: "src/routes/public.ts"
      provides: "Updated auth page route definitions"
      contains: "/app/auth/signup"
    - path: "public/login.html"
      provides: "Login page with updated links"
      contains: "/app/auth/signup"
    - path: "public/signup.html"
      provides: "Signup page with updated links"
      contains: "/app/auth/login"
  key_links:
    - from: "public/index.html"
      to: "/app/auth/signup"
      via: "href link"
      pattern: 'href="/app/auth/signup"'
    - from: "public/login.html"
      to: "/app/auth/signup"
      via: "href link"
      pattern: 'href="/app/auth/signup"'
---

<objective>
Migrate auth page routes from /auth/* to /app/auth/* for consistent URL structure.

Purpose: Part 1 of route restructure - establishes /app/auth/* pattern for user auth pages while keeping API routes at /auth/* unchanged.

Output: Auth pages accessible at new /app/auth/* paths, all internal links updated, old routes return 404.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/12-route-restructure/12-CONTEXT.md
@.planning/phases/12-route-restructure/12-RESEARCH.md
@src/routes/public.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update auth page routes in backend</name>
  <files>src/routes/public.ts</files>
  <action>
Update the auth page route definitions from /auth/* to /app/auth/*:

1. Change `/auth/signup` route to `/app/auth/signup` (line ~14)
2. Change `/auth/login` route to `/app/auth/login` (line ~22)
3. Update the JSDoc comments to reflect new paths

IMPORTANT: Only change the PAGE routes (GET requests that serve HTML). Do NOT touch:
- API routes in src/routes/auth.ts (/auth/login POST, /auth/signup POST, etc.)
- The actual HTML file paths being served (they stay at public/signup.html, etc.)

Before:
```typescript
publicRouter.get('/auth/signup', (_req: Request, res: Response): void => {
  res.sendFile(join(__dirname, '../../public/signup.html'));
});
```

After:
```typescript
publicRouter.get('/app/auth/signup', (_req: Request, res: Response): void => {
  res.sendFile(join(__dirname, '../../public/signup.html'));
});
```
  </action>
  <verify>
Run TypeScript compilation: `npx tsc --noEmit`
Grep to confirm new routes: `grep -n "/app/auth/" src/routes/public.ts`
Grep to confirm old routes removed: `grep -n "'/auth/signup'\|'/auth/login'" src/routes/public.ts` (should return nothing)
  </verify>
  <done>
- /app/auth/signup route defined in public.ts
- /app/auth/login route defined in public.ts
- Old /auth/signup and /auth/login page routes no longer exist
- TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Update auth links in all user-facing HTML pages</name>
  <files>
public/index.html
public/login.html
public/signup.html
public/dashboard.html
public/claim.html
public/team-dashboard.html
public/checkout-success.html
  </files>
  <action>
Update all href and JavaScript location references from /auth/* to /app/auth/* in user-facing pages.

Specific changes needed:

1. **public/index.html** (landing page):
   - Change `href="/auth/signup"` to `href="/app/auth/signup"`
   - Change `href="/auth/login"` to `href="/app/auth/login"`
   - Check any JavaScript redirects

2. **public/login.html**:
   - Change `href="/auth/signup"` to `href="/app/auth/signup"` (the "Create one" link)
   - Check any JavaScript redirects (e.g., after successful login)

3. **public/signup.html**:
   - Change `href="/auth/login"` to `href="/app/auth/login"` (the "Login here" link)
   - Check any JavaScript redirects

4. **public/dashboard.html**:
   - Check for any /auth/* links or redirects (logout redirect, etc.)

5. **public/claim.html**:
   - Check for any /auth/* links or redirects

6. **public/team-dashboard.html**:
   - Check for any /auth/* links or redirects

7. **public/checkout-success.html**:
   - Check for any /auth/* links (login link for returning users)

IMPORTANT - Do NOT change:
- API fetch calls to /auth/login, /auth/signup (POST endpoints) - these stay at /auth/*
- Links to /app/dashboard, /app/claim, /app/team (already correct)
- Static asset paths
- Any non-auth routes

Pattern to search: `href="/auth/` and `location.href = '/auth/` and `window.location = '/auth/`
  </action>
  <verify>
Grep to confirm no old auth page links remain:
```
grep -r 'href="/auth/signup"\|href="/auth/login"' public/*.html
```
Should return no results (only API fetch calls should reference /auth/).

Grep to confirm new links exist:
```
grep -r 'href="/app/auth/' public/*.html
```
Should show updated links.
  </verify>
  <done>
- All href links to /auth/signup changed to /app/auth/signup
- All href links to /auth/login changed to /app/auth/login
- All JavaScript location redirects updated
- API fetch calls to /auth/* remain unchanged
- No orphaned /auth/signup or /auth/login page links in user HTML files
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify auth route migration</name>
  <files>src/routes/public.ts</files>
  <action>
Start the dev server and verify the route changes work correctly:

1. Run `npm run dev` to start the server
2. Test new routes respond correctly:
   - GET /app/auth/signup should return signup.html (200 OK)
   - GET /app/auth/login should return login.html (200 OK)
3. Test old routes return 404:
   - GET /auth/signup should return 404
   - GET /auth/login should return 404
4. Verify API routes still work:
   - POST /auth/signup should still work (not a page route)
   - POST /auth/login should still work (not a page route)

Use curl to verify:
```bash
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000/app/auth/signup
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000/app/auth/login
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000/auth/signup
curl -s -o /dev/null -w "%{http_code}" http://localhost:3000/auth/login
```

Expected: 200, 200, 404, 404
  </action>
  <verify>
- GET /app/auth/signup returns 200
- GET /app/auth/login returns 200
- GET /auth/signup returns 404
- GET /auth/login returns 404
- No console errors in server output
  </verify>
  <done>
- New auth page routes serve HTML correctly
- Old auth page routes return 404
- API routes unaffected
- Server starts without errors
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Route definitions:** `grep -n "app/auth" src/routes/public.ts` shows both routes
2. **No old routes:** `grep -n "'/auth/signup'\|'/auth/login'" src/routes/public.ts` returns empty
3. **HTML links updated:** `grep -rn "/app/auth/" public/*.html` shows updated links
4. **No stale links:** `grep -rn 'href="/auth/signup"\|href="/auth/login"' public/` returns empty
5. **TypeScript compiles:** `npx tsc --noEmit` succeeds
6. **Server starts:** `npm run dev` starts without errors
</verification>

<success_criteria>
- Auth pages accessible at /app/auth/signup and /app/auth/login
- Old /auth/signup and /auth/login page routes return 404
- All internal links point to new paths
- API routes at /auth/* still function (POST login/signup)
- TypeScript compiles without errors
- Server starts and responds correctly
</success_criteria>

<output>
After completion, create `.planning/phases/12-route-restructure/12-01-SUMMARY.md`
</output>
