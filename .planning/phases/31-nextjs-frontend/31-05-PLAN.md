---
phase: 31-nextjs-frontend
plan: 05
type: execute
wave: 3
depends_on: ["31-03", "31-04"]
files_modified:
  - dashboard/src/components/layout/Sidebar.tsx
  - dashboard/src/components/layout/Header.tsx
  - dashboard/src/components/layout/index.ts
  - dashboard/src/app/dashboard/layout.tsx
  - dashboard/src/app/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard has collapsible sidebar with 'The Realm' and 'My Keep' sections"
    - "Header shows logo and gold count placeholder"
    - "Overview page displays welcome message and placeholder cards"
    - "Layout wraps all /dashboard/* pages"
  artifacts:
    - path: "dashboard/src/components/layout/Sidebar.tsx"
      provides: "Collapsible sidebar navigation"
      contains: "The Realm"
    - path: "dashboard/src/app/dashboard/layout.tsx"
      provides: "Dashboard shell layout"
      contains: "DashboardLayout"
    - path: "dashboard/src/app/dashboard/page.tsx"
      provides: "Overview page"
      contains: "Welcome"
  key_links:
    - from: "dashboard/src/app/dashboard/layout.tsx"
      to: "dashboard/src/components/layout/Sidebar.tsx"
      via: "import and render"
      pattern: "import.*Sidebar.*from"
    - from: "dashboard/src/app/dashboard/layout.tsx"
      to: "dashboard/src/components/layout/Header.tsx"
      via: "import and render"
      pattern: "import.*Header.*from"
---

<objective>
Create the dashboard shell layout with medieval-themed sidebar navigation and header, plus a placeholder overview page.

Purpose: Establish the visual framework that all dashboard pages will live in, with the navigation structure defined in CONTEXT.md ("The Realm" and "My Keep" sections).

Output: Working dashboard shell at /dashboard with sidebar, header, and overview content that members see after authentication.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/31-nextjs-frontend/31-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Sidebar component with medieval navigation</name>
  <files>
    dashboard/src/components/layout/Sidebar.tsx
    dashboard/src/components/layout/index.ts
  </files>
  <action>
Create the sidebar navigation with sections per CONTEXT.md: "The Realm" (features) and "My Keep" (personal).

Create `dashboard/src/components/layout/Sidebar.tsx`:
```tsx
'use client';

import { useState } from 'react';
import Link from 'next/link';
import { usePathname } from 'next/navigation';
import {
  LayoutDashboard,
  BarChart3,
  FolderOpen,
  Trophy,
  User,
  Settings,
  CreditCard,
  ChevronLeft,
  ChevronRight,
  Coins,
} from 'lucide-react';

interface NavItem {
  label: string;
  href: string;
  icon: React.ReactNode;
}

const realmNavItems: NavItem[] = [
  { label: 'Overview', href: '/dashboard', icon: <LayoutDashboard size={20} /> },
  { label: 'Benchmarks', href: '/dashboard/benchmarks', icon: <BarChart3 size={20} /> },
  { label: 'Resources', href: '/dashboard/resources', icon: <FolderOpen size={20} /> },
  { label: 'Guild Rankings', href: '/dashboard/leaderboard', icon: <Trophy size={20} /> },
];

const keepNavItems: NavItem[] = [
  { label: 'Profile', href: '/dashboard/profile', icon: <User size={20} /> },
  { label: 'Account', href: '/dashboard/account', icon: <Settings size={20} /> },
  { label: 'Billing', href: '/dashboard/billing', icon: <CreditCard size={20} /> },
];

interface SidebarProps {
  goldCount?: number;
}

/**
 * Sidebar navigation with medieval theme
 *
 * Per CONTEXT.md:
 * - Collapsible sidebar
 * - Grouped under "The Realm" (features) and "My Keep" (personal)
 * - Rank badge placeholder above navigation
 * - Gold summary in header area
 */
export function Sidebar({ goldCount = 0 }: SidebarProps) {
  const [collapsed, setCollapsed] = useState(false);
  const pathname = usePathname();

  return (
    <aside
      className={`
        flex flex-col h-full
        bg-card border-r-2 border-border
        transition-all duration-300 ease-in-out
        ${collapsed ? 'w-16' : 'w-64'}
      `}
    >
      {/* Logo and Gold Count */}
      <div className="p-4 border-b-2 border-border">
        {!collapsed && (
          <div className="flex items-center justify-between mb-3">
            <span className="font-bold text-foreground">TRC</span>
            <div className="flex items-center gap-1 text-gold-dark">
              <Coins size={16} />
              <span className="text-sm font-semibold">{goldCount}</span>
            </div>
          </div>
        )}
        {collapsed && (
          <div className="flex justify-center">
            <Coins size={20} className="text-gold" />
          </div>
        )}
      </div>

      {/* Rank Badge Placeholder */}
      {!collapsed && (
        <div className="p-4 border-b-2 border-border">
          <div className="bg-accent rounded-[8px] p-3 text-center pixel-border border-gold/30">
            <span className="text-xs text-muted-foreground uppercase tracking-wide">Rank</span>
            <p className="font-semibold text-foreground">Squire</p>
          </div>
        </div>
      )}

      {/* Navigation */}
      <nav className="flex-1 overflow-y-auto py-4">
        {/* The Realm Section */}
        <NavSection
          title="The Realm"
          items={realmNavItems}
          collapsed={collapsed}
          pathname={pathname}
        />

        {/* My Keep Section */}
        <NavSection
          title="My Keep"
          items={keepNavItems}
          collapsed={collapsed}
          pathname={pathname}
        />
      </nav>

      {/* Collapse Toggle */}
      <div className="p-2 border-t-2 border-border">
        <button
          onClick={() => setCollapsed(!collapsed)}
          className="
            w-full flex items-center justify-center
            p-2 rounded-[8px]
            text-muted-foreground hover:text-foreground
            hover:bg-accent transition-colors
          "
          aria-label={collapsed ? 'Expand sidebar' : 'Collapse sidebar'}
        >
          {collapsed ? <ChevronRight size={20} /> : <ChevronLeft size={20} />}
        </button>
      </div>
    </aside>
  );
}

interface NavSectionProps {
  title: string;
  items: NavItem[];
  collapsed: boolean;
  pathname: string;
}

function NavSection({ title, items, collapsed, pathname }: NavSectionProps) {
  return (
    <div className="mb-6">
      {!collapsed && (
        <h3 className="px-4 mb-2 text-xs font-semibold text-muted-foreground uppercase tracking-wider">
          {title}
        </h3>
      )}
      <ul className="space-y-1 px-2">
        {items.map((item) => {
          const isActive = pathname === item.href;
          return (
            <li key={item.href}>
              <Link
                href={item.href}
                className={`
                  flex items-center gap-3 px-3 py-2 rounded-[8px]
                  transition-all duration-150
                  ${collapsed ? 'justify-center' : ''}
                  ${
                    isActive
                      ? 'bg-gold/10 text-gold-dark border-2 border-gold/30 shadow-[2px_2px_0px_0px_rgba(212,160,23,0.2)]'
                      : 'text-muted-foreground hover:text-foreground hover:bg-accent'
                  }
                `}
                title={collapsed ? item.label : undefined}
              >
                {item.icon}
                {!collapsed && <span className="font-medium">{item.label}</span>}
              </Link>
            </li>
          );
        })}
      </ul>
    </div>
  );
}

export default Sidebar;
```

Create `dashboard/src/components/layout/index.ts`:
```typescript
export { Sidebar } from './Sidebar';
export { Header } from './Header';
```
  </action>
  <verify>
- `ls dashboard/src/components/layout/Sidebar.tsx` (file exists)
- `grep "The Realm" dashboard/src/components/layout/Sidebar.tsx` (section present)
- `grep "My Keep" dashboard/src/components/layout/Sidebar.tsx` (section present)
  </verify>
  <done>Sidebar component created with collapsible navigation and medieval sections</done>
</task>

<task type="auto">
  <name>Task 2: Create Header component</name>
  <files>
    dashboard/src/components/layout/Header.tsx
  </files>
  <action>
Create the dashboard header component.

Create `dashboard/src/components/layout/Header.tsx`:
```tsx
'use client';

import { Menu, Bell, User } from 'lucide-react';
import { Button } from '@/components/ui';

interface HeaderProps {
  /** Callback when mobile menu button is clicked */
  onMenuClick?: () => void;
  /** Member name for display */
  memberName?: string;
}

/**
 * Dashboard header component
 *
 * Per CONTEXT.md:
 * - Logo + User avatar + Gold count
 * - Mobile: shows menu button for sidebar toggle
 */
export function Header({ onMenuClick, memberName }: HeaderProps) {
  return (
    <header className="
      flex items-center justify-between
      h-16 px-4
      bg-card border-b-2 border-border
    ">
      {/* Left: Mobile menu + Page title area */}
      <div className="flex items-center gap-4">
        {/* Mobile menu button - only show on small screens */}
        <button
          onClick={onMenuClick}
          className="lg:hidden p-2 rounded-[8px] text-muted-foreground hover:text-foreground hover:bg-accent"
          aria-label="Toggle menu"
        >
          <Menu size={24} />
        </button>

        {/* Page title area - can be customized per page */}
        <div>
          <h1 className="text-lg font-semibold text-foreground">Dashboard</h1>
        </div>
      </div>

      {/* Right: Actions + User */}
      <div className="flex items-center gap-3">
        {/* Notifications placeholder */}
        <button
          className="p-2 rounded-[8px] text-muted-foreground hover:text-foreground hover:bg-accent relative"
          aria-label="Notifications"
        >
          <Bell size={20} />
          {/* Notification dot */}
          <span className="absolute top-1 right-1 w-2 h-2 bg-gold rounded-full" />
        </button>

        {/* User menu placeholder */}
        <button
          className="
            flex items-center gap-2 p-2 rounded-[8px]
            text-muted-foreground hover:text-foreground hover:bg-accent
          "
        >
          <div className="w-8 h-8 rounded-full bg-accent flex items-center justify-center">
            <User size={16} />
          </div>
          <span className="hidden sm:inline text-sm font-medium">
            {memberName || 'Member'}
          </span>
        </button>
      </div>
    </header>
  );
}

export default Header;
```
  </action>
  <verify>
- `ls dashboard/src/components/layout/Header.tsx` (file exists)
- `grep "Menu" dashboard/src/components/layout/Header.tsx` (mobile menu present)
  </verify>
  <done>Header component created with mobile menu, notifications, and user area</done>
</task>

<task type="auto">
  <name>Task 3: Create dashboard layout and overview page</name>
  <files>
    dashboard/src/app/dashboard/layout.tsx
    dashboard/src/app/dashboard/page.tsx
  </files>
  <action>
Create the dashboard layout that wraps all /dashboard/* pages, and the overview landing page.

1. Create `dashboard/src/app/dashboard/layout.tsx`:
```tsx
'use client';

import { useState } from 'react';
import { Sidebar, Header } from '@/components/layout';

interface DashboardLayoutProps {
  children: React.ReactNode;
}

/**
 * Dashboard shell layout
 *
 * Provides the common structure for all dashboard pages:
 * - Sidebar navigation (collapsible)
 * - Header with user info
 * - Main content area
 *
 * Per CONTEXT.md:
 * - Light mode only
 * - Parchment background
 * - Medieval pixel aesthetic
 */
export default function DashboardLayout({ children }: DashboardLayoutProps) {
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);

  return (
    <div className="flex h-screen bg-background">
      {/* Sidebar - hidden on mobile, shown on lg+ */}
      <div className="hidden lg:flex">
        <Sidebar goldCount={150} />
      </div>

      {/* Mobile sidebar overlay */}
      {mobileMenuOpen && (
        <div className="fixed inset-0 z-50 lg:hidden">
          {/* Backdrop */}
          <div
            className="absolute inset-0 bg-foreground/50"
            onClick={() => setMobileMenuOpen(false)}
          />
          {/* Sidebar */}
          <div className="absolute left-0 top-0 h-full w-64 bg-card shadow-lg">
            <Sidebar goldCount={150} />
          </div>
        </div>
      )}

      {/* Main content area */}
      <div className="flex-1 flex flex-col min-w-0">
        <Header
          onMenuClick={() => setMobileMenuOpen(!mobileMenuOpen)}
          memberName="Guild Member"
        />

        {/* Page content */}
        <main className="flex-1 overflow-y-auto p-6">
          {children}
        </main>
      </div>
    </div>
  );
}
```

2. Create `dashboard/src/app/dashboard/page.tsx`:
```tsx
import { Card, CardHeader, CardTitle, CardDescription, CardContent } from '@/components/ui';
import { Coins, Trophy, BarChart3, FolderOpen, Flame } from 'lucide-react';

/**
 * Dashboard Overview Page
 *
 * Landing page for authenticated members showing:
 * - Welcome message
 * - Quick stats (gold, rank, streak)
 * - Quick action cards
 */
export default function DashboardOverview() {
  return (
    <div className="space-y-6">
      {/* Welcome Section */}
      <div>
        <h1 className="text-2xl font-bold text-foreground mb-2">
          Welcome to The Realm
        </h1>
        <p className="text-muted-foreground">
          Your guild dashboard awaits. Track your progress, compare benchmarks, and access resources.
        </p>
      </div>

      {/* Quick Stats */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <StatCard
          icon={<Coins className="text-gold" size={24} />}
          label="Gold Earned"
          value="150"
          subtext="+25 this week"
        />
        <StatCard
          icon={<Trophy className="text-gold-dark" size={24} />}
          label="Guild Rank"
          value="#42"
          subtext="Top 15%"
        />
        <StatCard
          icon={<Flame className="text-orange-500" size={24} />}
          label="Current Streak"
          value="7 days"
          subtext="Keep it going!"
        />
      </div>

      {/* Quick Actions */}
      <div>
        <h2 className="text-lg font-semibold text-foreground mb-4">Quick Actions</h2>
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          <ActionCard
            href="/dashboard/benchmarks"
            icon={<BarChart3 size={24} />}
            title="Submit Benchmark"
            description="Share your data and see how you compare to peers"
            reward="+50 Gold"
          />
          <ActionCard
            href="/dashboard/resources"
            icon={<FolderOpen size={24} />}
            title="Browse Resources"
            description="Access templates, SOPs, and learning materials"
            reward="+5 Gold per download"
          />
        </div>
      </div>

      {/* Recent Activity Placeholder */}
      <Card>
        <CardHeader>
          <CardTitle>Recent Activity</CardTitle>
          <CardDescription>Your latest actions in the guild</CardDescription>
        </CardHeader>
        <CardContent>
          <div className="space-y-3">
            <ActivityItem
              action="Earned gold from Discord activity"
              points="+12"
              time="2 hours ago"
            />
            <ActivityItem
              action="Downloaded 'Revenue Operations Playbook'"
              points="+5"
              time="Yesterday"
            />
            <ActivityItem
              action="Submitted compensation benchmark"
              points="+50"
              time="3 days ago"
            />
          </div>
        </CardContent>
      </Card>
    </div>
  );
}

interface StatCardProps {
  icon: React.ReactNode;
  label: string;
  value: string;
  subtext: string;
}

function StatCard({ icon, label, value, subtext }: StatCardProps) {
  return (
    <Card>
      <CardContent className="pt-6">
        <div className="flex items-start justify-between">
          <div>
            <p className="text-sm text-muted-foreground mb-1">{label}</p>
            <p className="text-2xl font-bold text-foreground">{value}</p>
            <p className="text-sm text-muted-foreground mt-1">{subtext}</p>
          </div>
          <div className="p-2 bg-accent rounded-[8px]">
            {icon}
          </div>
        </div>
      </CardContent>
    </Card>
  );
}

interface ActionCardProps {
  href: string;
  icon: React.ReactNode;
  title: string;
  description: string;
  reward: string;
}

function ActionCard({ href, icon, title, description, reward }: ActionCardProps) {
  return (
    <a href={href} className="block group">
      <Card className="h-full hover-lift">
        <CardContent className="pt-6">
          <div className="flex items-start gap-4">
            <div className="p-3 bg-accent rounded-[8px] text-foreground group-hover:bg-gold/10 group-hover:text-gold-dark transition-colors">
              {icon}
            </div>
            <div className="flex-1">
              <h3 className="font-semibold text-foreground group-hover:text-gold-dark transition-colors">
                {title}
              </h3>
              <p className="text-sm text-muted-foreground mt-1">{description}</p>
              <p className="text-sm font-medium text-gold-dark mt-2">{reward}</p>
            </div>
          </div>
        </CardContent>
      </Card>
    </a>
  );
}

interface ActivityItemProps {
  action: string;
  points: string;
  time: string;
}

function ActivityItem({ action, points, time }: ActivityItemProps) {
  return (
    <div className="flex items-center justify-between py-2 border-b border-border last:border-0">
      <div>
        <p className="text-sm text-foreground">{action}</p>
        <p className="text-xs text-muted-foreground">{time}</p>
      </div>
      <span className="text-sm font-semibold text-gold-dark">{points}</span>
    </div>
  );
}
```
  </action>
  <verify>
- `ls dashboard/src/app/dashboard/layout.tsx` (file exists)
- `ls dashboard/src/app/dashboard/page.tsx` (file exists)
- `grep "Sidebar" dashboard/src/app/dashboard/layout.tsx` (sidebar imported)
- `grep "Welcome to The Realm" dashboard/src/app/dashboard/page.tsx` (welcome text present)
  </verify>
  <done>Dashboard layout and overview page created with medieval theme</done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `cd dashboard && npm run build` completes without errors
2. Start both apps:
   - Terminal 1: `cd dashboard && npm run dev` (Next.js on port 3000)
   - Terminal 2: `npm run dev` (Express on port 4000)
3. Visit http://localhost:4000/dashboard (through proxy)
4. Should redirect to /login (no token yet)
5. OR visit http://localhost:3000/dashboard directly to see the layout (no auth check in dev)
</verification>

<success_criteria>
- Sidebar has "The Realm" section with Overview, Benchmarks, Resources, Guild Rankings
- Sidebar has "My Keep" section with Profile, Account, Billing
- Sidebar collapses to icons only when toggled
- Header shows mobile menu button, notifications, user area
- Overview page shows welcome message, stat cards (Gold, Rank, Streak)
- Quick action cards link to benchmarks and resources
- Recent activity section shows placeholder items
- All components use pixel-shadow and medieval theme styling
</success_criteria>

<output>
After completion, create `.planning/phases/31-nextjs-frontend/31-05-SUMMARY.md`
</output>
