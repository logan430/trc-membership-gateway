---
phase: 32-member-dashboard-pages
plan: 05
type: execute
wave: 2
depends_on: ["32-01"]
files_modified:
  - dashboard/src/lib/api.ts
  - dashboard/src/hooks/useLeaderboard.ts
  - dashboard/src/components/leaderboard/LeaderboardTable.tsx
  - dashboard/src/components/leaderboard/RankBadge.tsx
  - dashboard/src/components/leaderboard/PeriodTabs.tsx
  - dashboard/src/components/leaderboard/ResetCountdown.tsx
  - dashboard/src/components/leaderboard/index.ts
  - dashboard/src/app/dashboard/leaderboard/page.tsx
  - src/routes/leaderboard.ts
  - src/index.ts
autonomous: true

must_haves:
  truths:
    - "Member can view top 25 members ranked by points"
    - "Member sees their own rank even if outside top 25"
    - "Leaderboard has supportive tone focusing on personal progress"
    - "Loading state shows while data fetches"
    - "Member can toggle between This Month and All Time views"
    - "Countdown timer shows days/hours until monthly reset"
    - "Members with leaderboardVisible=false are excluded from rankings"
  artifacts:
    - path: "dashboard/src/hooks/useLeaderboard.ts"
      provides: "Leaderboard data hook with period support"
      exports: ["useLeaderboard"]
    - path: "dashboard/src/components/leaderboard/LeaderboardTable.tsx"
      provides: "Leaderboard table with pinned member row"
      exports: ["LeaderboardTable"]
    - path: "dashboard/src/components/leaderboard/PeriodTabs.tsx"
      provides: "This Month / All Time toggle tabs"
      exports: ["PeriodTabs"]
    - path: "dashboard/src/components/leaderboard/ResetCountdown.tsx"
      provides: "Countdown timer to monthly reset"
      exports: ["ResetCountdown"]
    - path: "dashboard/src/app/dashboard/leaderboard/page.tsx"
      provides: "Leaderboard page"
      min_lines: 100
  key_links:
    - from: "dashboard/src/app/dashboard/leaderboard/page.tsx"
      to: "/api/leaderboard"
      via: "useLeaderboard hook"
      pattern: "useLeaderboard\\("
---

<objective>
Build the leaderboard page with supportive tone, member position pinning, monthly/all-time toggle, and reset countdown.

Purpose: Members can see how they rank among peers, with their position always visible. Supportive messaging focuses on personal progress. Monthly leaderboard resets with all-time hall of fame preserved.

Output: /dashboard/leaderboard page with top 25 rankings, pinned member row, period tabs (This Month / All Time), countdown to reset, and "how to earn points" section.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-member-dashboard-pages/32-CONTEXT.md
@.planning/phases/32-member-dashboard-pages/32-RESEARCH.md

# Note: Leaderboard backend API needs to be created or may use points data
# Check if /api/leaderboard exists, otherwise build from points/summary
@src/routes/points.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create leaderboard API endpoint with period filter and privacy support</name>
  <files>
    src/routes/leaderboard.ts
    src/index.ts
    dashboard/src/lib/api.ts
    dashboard/src/hooks/useLeaderboard.ts
  </files>
  <action>
1. Create src/routes/leaderboard.ts (backend API):
   ```typescript
   /**
    * Member-facing leaderboard API
    * Supports monthly vs all-time periods and respects leaderboardVisible privacy setting
    */
   import { Router } from 'express';
   import { requireAuth, type AuthenticatedRequest } from '../middleware/session.js';
   import { prisma } from '../lib/prisma.js';

   export const leaderboardRouter = Router();

   /**
    * GET /api/leaderboard
    * Query params:
    *   - period: 'month' | 'alltime' (default: 'month')
    * Returns top 25 members and current member's rank
    * Excludes members where leaderboardVisible = false (GAME-11)
    */
   leaderboardRouter.get('/', requireAuth, async (req: AuthenticatedRequest, res) => {
     const memberId = req.memberId!;
     const period = req.query.period === 'alltime' ? 'alltime' : 'month';

     // Calculate start of current month for monthly filter
     const now = new Date();
     const monthStart = new Date(now.getFullYear(), now.getMonth(), 1);

     // Base where clause - only include members visible on leaderboard (GAME-11)
     const baseWhere = {
       subscriptionStatus: 'ACTIVE' as const,
       leaderboardVisible: true, // Respect privacy setting
     };

     // For monthly, we need to sum points earned this month from transactions
     // For all-time, use totalPoints directly
     let topMembers;
     let currentMemberData;
     let currentMemberRank = 0;

     if (period === 'month') {
       // Get monthly points by aggregating transactions
       const monthlyRankings = await prisma.$queryRaw<Array<{
         id: string;
         discordUsername: string | null;
         monthlyPoints: bigint;
         currentStreak: number;
       }>>`
         SELECT
           m.id,
           m."discordUsername",
           COALESCE(SUM(pt.points), 0) as "monthlyPoints",
           m."currentStreak"
         FROM "Member" m
         LEFT JOIN "PointTransaction" pt ON pt."memberId" = m.id
           AND pt."createdAt" >= ${monthStart}
         WHERE m."subscriptionStatus" = 'ACTIVE'
           AND m."leaderboardVisible" = true
         GROUP BY m.id
         HAVING COALESCE(SUM(pt.points), 0) > 0
         ORDER BY "monthlyPoints" DESC
         LIMIT 25
       `;

       topMembers = monthlyRankings.map((m, i) => ({
         id: m.id,
         discordUsername: m.discordUsername,
         totalPoints: Number(m.monthlyPoints),
         currentStreak: m.currentStreak,
         rank: i + 1,
         isCurrent: m.id === memberId,
       }));

       // Get current member's monthly points and rank
       const currentMemberMonthly = await prisma.$queryRaw<Array<{
         monthlyPoints: bigint;
       }>>`
         SELECT COALESCE(SUM(pt.points), 0) as "monthlyPoints"
         FROM "Member" m
         LEFT JOIN "PointTransaction" pt ON pt."memberId" = m.id
           AND pt."createdAt" >= ${monthStart}
         WHERE m.id = ${memberId}
         GROUP BY m.id
       `;

       const currentMemberPoints = currentMemberMonthly[0] ? Number(currentMemberMonthly[0].monthlyPoints) : 0;

       // Count members with more monthly points
       const membersAbove = await prisma.$queryRaw<Array<{ count: bigint }>>`
         SELECT COUNT(*) as count FROM (
           SELECT m.id
           FROM "Member" m
           LEFT JOIN "PointTransaction" pt ON pt."memberId" = m.id
             AND pt."createdAt" >= ${monthStart}
           WHERE m."subscriptionStatus" = 'ACTIVE'
             AND m."leaderboardVisible" = true
           GROUP BY m.id
           HAVING COALESCE(SUM(pt.points), 0) > ${currentMemberPoints}
         ) sub
       `;

       currentMemberRank = Number(membersAbove[0]?.count || 0) + 1;

       const member = await prisma.member.findUnique({
         where: { id: memberId },
         select: { id: true, discordUsername: true, currentStreak: true },
       });

       currentMemberData = member ? {
         ...member,
         totalPoints: currentMemberPoints,
         rank: currentMemberRank,
       } : null;

     } else {
       // All-time - use totalPoints directly
       topMembers = await prisma.member.findMany({
         where: {
           ...baseWhere,
           totalPoints: { gt: 0 },
         },
         orderBy: { totalPoints: 'desc' },
         take: 25,
         select: {
           id: true,
           discordUsername: true,
           totalPoints: true,
           currentStreak: true,
         },
       });

       topMembers = topMembers.map((m, i) => ({
         ...m,
         rank: i + 1,
         isCurrent: m.id === memberId,
       }));

       // Get current member's data
       const currentMember = await prisma.member.findUnique({
         where: { id: memberId },
         select: {
           id: true,
           discordUsername: true,
           totalPoints: true,
           currentStreak: true,
         },
       });

       // Calculate current member's rank
       if (currentMember) {
         const membersAbove = await prisma.member.count({
           where: {
             totalPoints: { gt: currentMember.totalPoints },
             subscriptionStatus: 'ACTIVE',
             leaderboardVisible: true,
           },
         });
         currentMemberRank = membersAbove + 1;
       }

       currentMemberData = currentMember ? {
         ...currentMember,
         rank: currentMemberRank,
       } : null;
     }

     // Get total participant count (visible members with points)
     const totalParticipants = await prisma.member.count({
       where: {
         totalPoints: { gt: 0 },
         subscriptionStatus: 'ACTIVE',
         leaderboardVisible: true,
       },
     });

     // Calculate next reset date (first of next month)
     const nextMonth = new Date(now.getFullYear(), now.getMonth() + 1, 1);

     res.json({
       period,
       topMembers,
       currentMember: currentMemberData,
       totalParticipants,
       nextResetAt: nextMonth.toISOString(),
     });
   });
   ```

2. Register the router in src/index.ts:
   - Import leaderboardRouter
   - Add: app.use('/api/leaderboard', leaderboardRouter);

3. Update dashboard/src/lib/api.ts:
   - Add leaderboardApi:
     ```typescript
     export type LeaderboardPeriod = 'month' | 'alltime';

     export interface LeaderboardMember {
       id: string;
       discordUsername: string | null;
       totalPoints: number;
       currentStreak: number;
       rank: number;
       isCurrent?: boolean;
     }

     export interface LeaderboardResponse {
       period: LeaderboardPeriod;
       topMembers: LeaderboardMember[];
       currentMember: LeaderboardMember | null;
       totalParticipants: number;
       nextResetAt: string;
     }

     export const leaderboardApi = {
       get: (period: LeaderboardPeriod = 'month') =>
         apiFetch<LeaderboardResponse>(`/api/leaderboard?period=${period}`),
     };
     ```

4. Create dashboard/src/hooks/useLeaderboard.ts:
   ```typescript
   'use client';

   import { useQuery } from '@tanstack/react-query';
   import { leaderboardApi, LeaderboardPeriod } from '@/lib/api';

   export function useLeaderboard(period: LeaderboardPeriod = 'month') {
     return useQuery({
       queryKey: ['leaderboard', period],
       queryFn: () => leaderboardApi.get(period),
       staleTime: 5 * 60_000, // 5 minutes per JOBS-03
       refetchInterval: 5 * 60_000, // Auto-refresh every 5 minutes
     });
   }
   ```
  </action>
  <verify>
    - src/routes/leaderboard.ts created with period query param and leaderboardVisible filter
    - Router registered in src/index.ts
    - No TypeScript errors in backend: npx tsc --noEmit
    - No TypeScript errors in dashboard: cd dashboard && npx tsc --noEmit
  </verify>
  <done>Leaderboard API endpoint and hook created with monthly/all-time period support and privacy filtering</done>
</task>

<task type="auto">
  <name>Task 2: Create leaderboard components including period tabs and countdown</name>
  <files>
    dashboard/src/components/leaderboard/LeaderboardTable.tsx
    dashboard/src/components/leaderboard/RankBadge.tsx
    dashboard/src/components/leaderboard/PeriodTabs.tsx
    dashboard/src/components/leaderboard/ResetCountdown.tsx
    dashboard/src/components/leaderboard/index.ts
  </files>
  <action>
1. Create dashboard/src/components/leaderboard/RankBadge.tsx:
   ```typescript
   import { Trophy, Medal, Award } from 'lucide-react';

   interface RankBadgeProps {
     rank: number;
   }

   export function RankBadge({ rank }: RankBadgeProps) {
     if (rank === 1) {
       return (
         <div className="flex items-center justify-center w-8 h-8 bg-gold/20 rounded-full">
           <Trophy className="text-gold" size={16} />
         </div>
       );
     }
     if (rank === 2) {
       return (
         <div className="flex items-center justify-center w-8 h-8 bg-gray-300/20 rounded-full">
           <Medal className="text-gray-400" size={16} />
         </div>
       );
     }
     if (rank === 3) {
       return (
         <div className="flex items-center justify-center w-8 h-8 bg-amber-600/20 rounded-full">
           <Award className="text-amber-600" size={16} />
         </div>
       );
     }
     return (
       <div className="flex items-center justify-center w-8 h-8">
         <span className="text-sm font-medium text-muted-foreground">#{rank}</span>
       </div>
     );
   }
   ```

2. Create dashboard/src/components/leaderboard/PeriodTabs.tsx (GAME-12):
   ```typescript
   'use client';

   import type { LeaderboardPeriod } from '@/lib/api';

   interface PeriodTabsProps {
     period: LeaderboardPeriod;
     onPeriodChange: (period: LeaderboardPeriod) => void;
   }

   export function PeriodTabs({ period, onPeriodChange }: PeriodTabsProps) {
     return (
       <div className="inline-flex bg-accent rounded-[8px] p-1">
         <button
           onClick={() => onPeriodChange('month')}
           className={`px-4 py-2 text-sm font-medium rounded-[6px] transition-colors ${
             period === 'month'
               ? 'bg-background text-foreground shadow-sm'
               : 'text-muted-foreground hover:text-foreground'
           }`}
         >
           This Month
         </button>
         <button
           onClick={() => onPeriodChange('alltime')}
           className={`px-4 py-2 text-sm font-medium rounded-[6px] transition-colors ${
             period === 'alltime'
               ? 'bg-background text-foreground shadow-sm'
               : 'text-muted-foreground hover:text-foreground'
           }`}
         >
           All Time
         </button>
       </div>
     );
   }
   ```

3. Create dashboard/src/components/leaderboard/ResetCountdown.tsx (GAME-12):
   ```typescript
   'use client';

   import { useState, useEffect } from 'react';
   import { Clock } from 'lucide-react';

   interface ResetCountdownProps {
     nextResetAt: string;
   }

   export function ResetCountdown({ nextResetAt }: ResetCountdownProps) {
     const [timeLeft, setTimeLeft] = useState({ days: 0, hours: 0, minutes: 0 });

     useEffect(() => {
       const calculateTimeLeft = () => {
         const now = new Date();
         const reset = new Date(nextResetAt);
         const diffMs = reset.getTime() - now.getTime();

         if (diffMs <= 0) {
           return { days: 0, hours: 0, minutes: 0 };
         }

         const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));
         const hours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
         const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));

         return { days, hours, minutes };
       };

       setTimeLeft(calculateTimeLeft());

       const interval = setInterval(() => {
         setTimeLeft(calculateTimeLeft());
       }, 60_000); // Update every minute

       return () => clearInterval(interval);
     }, [nextResetAt]);

     return (
       <div className="flex items-center gap-2 text-sm text-muted-foreground">
         <Clock size={14} />
         <span>
           Resets in {timeLeft.days}d {timeLeft.hours}h {timeLeft.minutes}m
         </span>
       </div>
     );
   }
   ```

4. Create dashboard/src/components/leaderboard/LeaderboardTable.tsx:
   ```typescript
   'use client';

   import { Flame, User } from 'lucide-react';
   import { RankBadge } from './RankBadge';
   import type { LeaderboardMember } from '@/lib/api';

   interface LeaderboardTableProps {
     members: LeaderboardMember[];
     currentMember: LeaderboardMember | null;
   }

   export function LeaderboardTable({ members, currentMember }: LeaderboardTableProps) {
     const memberInTop25 = members.some((m) => m.isCurrent);

     return (
       <div className="relative">
         <div className="border border-border rounded-[8px] overflow-hidden">
           {/* Header */}
           <div className="px-4 py-3 bg-accent border-b border-border grid grid-cols-12 gap-2 text-sm font-medium text-muted-foreground">
             <div className="col-span-1">Rank</div>
             <div className="col-span-7">Member</div>
             <div className="col-span-2 text-right">Streak</div>
             <div className="col-span-2 text-right">Points</div>
           </div>

           {/* Rows */}
           <div className="divide-y divide-border">
             {members.map((member) => (
               <div
                 key={member.id}
                 className={`px-4 py-3 grid grid-cols-12 gap-2 items-center ${
                   member.isCurrent ? 'bg-gold/5' : ''
                 }`}
               >
                 <div className="col-span-1">
                   <RankBadge rank={member.rank} />
                 </div>
                 <div className="col-span-7 flex items-center gap-3">
                   <div className="w-8 h-8 bg-accent rounded-full flex items-center justify-center flex-shrink-0">
                     <User size={16} className="text-muted-foreground" />
                   </div>
                   <div className="min-w-0">
                     <span className="font-medium truncate block">
                       {member.discordUsername || 'Anonymous'}
                     </span>
                     {member.isCurrent && (
                       <span className="text-xs text-muted-foreground">(You)</span>
                     )}
                   </div>
                 </div>
                 <div className="col-span-2 text-right">
                   {member.currentStreak > 0 && (
                     <span className="inline-flex items-center gap-1 text-sm text-orange-500">
                       <Flame size={14} />
                       {member.currentStreak}
                     </span>
                   )}
                 </div>
                 <div className="col-span-2 text-right">
                   <span className="font-bold">{member.totalPoints.toLocaleString()}</span>
                 </div>
               </div>
             ))}
           </div>
         </div>

         {/* Pinned current member row if outside top 25 */}
         {!memberInTop25 && currentMember && (
           <div className="mt-4 border-2 border-gold/30 rounded-[8px] overflow-hidden pixel-border">
             <div className="px-4 py-3 bg-gold/5 grid grid-cols-12 gap-2 items-center">
               <div className="col-span-1">
                 <RankBadge rank={currentMember.rank} />
               </div>
               <div className="col-span-7 flex items-center gap-3">
                 <div className="w-8 h-8 bg-gold/20 rounded-full flex items-center justify-center flex-shrink-0">
                   <User size={16} className="text-gold-dark" />
                 </div>
                 <div className="min-w-0">
                   <span className="font-medium truncate block">
                     {currentMember.discordUsername || 'Anonymous'}
                   </span>
                   <span className="text-xs text-muted-foreground">(You)</span>
                 </div>
               </div>
               <div className="col-span-2 text-right">
                 {currentMember.currentStreak > 0 && (
                   <span className="inline-flex items-center gap-1 text-sm text-orange-500">
                     <Flame size={14} />
                     {currentMember.currentStreak}
                   </span>
                 )}
               </div>
               <div className="col-span-2 text-right">
                 <span className="font-bold">{currentMember.totalPoints.toLocaleString()}</span>
               </div>
             </div>
           </div>
         )}
       </div>
     );
   }
   ```

5. Create dashboard/src/components/leaderboard/index.ts:
   - Export LeaderboardTable, RankBadge, PeriodTabs, ResetCountdown
  </action>
  <verify>
    - RankBadge shows trophy/medal/award for top 3
    - LeaderboardTable renders member rows with rank, name, streak, points
    - PeriodTabs toggles between month and alltime
    - ResetCountdown shows days/hours/minutes until reset
    - Pinned row appears when member not in top 25
    - Components use pixel theme styling
  </verify>
  <done>Leaderboard components created with pinned member row, period tabs, and countdown timer</done>
</task>

<task type="auto">
  <name>Task 3: Create leaderboard page with period toggle and countdown</name>
  <files>
    dashboard/src/app/dashboard/leaderboard/page.tsx
  </files>
  <action>
Create dashboard/src/app/dashboard/leaderboard/page.tsx:

```typescript
'use client';

import { useState } from 'react';
import { GoldCoinsLoader, Card } from '@/components/ui';
import { LeaderboardTable, PeriodTabs, ResetCountdown } from '@/components/leaderboard';
import { useLeaderboard } from '@/hooks/useLeaderboard';
import { TrendingUp, Coins, Download, MessageSquare } from 'lucide-react';
import type { LeaderboardPeriod } from '@/lib/api';

export default function LeaderboardPage() {
  const [period, setPeriod] = useState<LeaderboardPeriod>('month');
  const { data, isLoading, error } = useLeaderboard(period);

  if (isLoading) {
    return (
      <div className="flex items-center justify-center h-64">
        <GoldCoinsLoader />
      </div>
    );
  }

  if (error) {
    return (
      <Card className="p-6 text-center">
        <p className="text-muted-foreground">Failed to load leaderboard</p>
      </Card>
    );
  }

  const percentile = data?.currentMember
    ? Math.round((1 - data.currentMember.rank / data.totalParticipants) * 100)
    : 0;

  return (
    <div className="space-y-6">
      {/* Header with supportive messaging */}
      <div>
        <h1 className="text-2xl font-bold text-foreground mb-2">Guild Rankings</h1>
        <p className="text-muted-foreground">
          Track your progress and celebrate the community's achievements.
        </p>
      </div>

      {/* Period tabs and countdown (GAME-12) */}
      <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <PeriodTabs period={period} onPeriodChange={setPeriod} />
        {period === 'month' && data?.nextResetAt && (
          <ResetCountdown nextResetAt={data.nextResetAt} />
        )}
      </div>

      {/* Your progress card - supportive tone per CONTEXT.md */}
      {data?.currentMember && (
        <Card className="p-4 sm:p-6">
          <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
            <div className="flex items-center gap-4 sm:gap-6">
              <div className="text-center">
                <div className="text-3xl sm:text-4xl font-bold text-gold-dark">
                  #{data.currentMember.rank}
                </div>
                <div className="text-sm text-muted-foreground">Your Rank</div>
              </div>
              <div className="h-12 w-px bg-border hidden sm:block" />
              <div>
                <div className="text-lg font-semibold">
                  {data.currentMember.totalPoints.toLocaleString()} points
                </div>
                <div className="text-sm text-muted-foreground">
                  {period === 'month' ? 'This month' : 'All time'}
                  {percentile > 0 && ` - Top ${100 - percentile}% of the guild`}
                </div>
              </div>
            </div>
            <div className="hidden md:flex items-center gap-2 text-sm text-muted-foreground">
              <TrendingUp size={16} className="text-success" />
              Keep earning to climb the ranks!
            </div>
          </div>
        </Card>
      )}

      {/* Leaderboard table */}
      <div>
        <div className="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4">
          <h2 className="text-lg font-semibold">
            Top 25 {period === 'month' ? 'This Month' : 'All Time'}
          </h2>
          <span className="text-sm text-muted-foreground">
            {data?.totalParticipants || 0} total participants
          </span>
        </div>
        <LeaderboardTable
          members={data?.topMembers || []}
          currentMember={data?.currentMember || null}
        />
      </div>

      {/* How to earn points */}
      <Card>
        <div className="p-4 border-b border-border">
          <h3 className="font-semibold">How to Earn Gold</h3>
        </div>
        <div className="p-4">
          <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
            <div className="flex items-center justify-between p-3 bg-accent rounded-[8px]">
              <div className="flex items-center gap-3">
                <Coins size={20} className="text-gold" />
                <span className="text-sm">Submit benchmark data</span>
              </div>
              <span className="font-semibold text-gold-dark">+50</span>
            </div>
            <div className="flex items-center justify-between p-3 bg-accent rounded-[8px]">
              <div className="flex items-center gap-3">
                <Download size={20} className="text-gold" />
                <span className="text-sm">Download a resource</span>
              </div>
              <span className="font-semibold text-gold-dark">+5</span>
            </div>
            <div className="flex items-center justify-between p-3 bg-accent rounded-[8px]">
              <div className="flex items-center gap-3">
                <MessageSquare size={20} className="text-gold" />
                <span className="text-sm">Discord activity (MEE6)</span>
              </div>
              <span className="font-semibold text-gold-dark">+1 / 100 XP</span>
            </div>
            <div className="flex items-center justify-between p-3 bg-accent rounded-[8px]">
              <div className="flex items-center gap-3">
                <TrendingUp size={20} className="text-gold" />
                <span className="text-sm">Complete introduction</span>
              </div>
              <span className="font-semibold text-gold-dark">+25</span>
            </div>
          </div>
        </div>
      </Card>
    </div>
  );
}
```
  </action>
  <verify>
    - cd dashboard && npm run build succeeds
    - Navigate to /dashboard/leaderboard
    - Period tabs toggle between "This Month" and "All Time"
    - Countdown timer appears when viewing monthly leaderboard
    - Your rank card shows current position and percentile
    - Top 25 table displays with correct data
    - If rank > 25: pinned row shows at bottom
    - "How to Earn Gold" section displays point values
    - Auto-refresh every 5 minutes (check network tab)
    - Mobile responsive: Test at 375px width - all elements stack properly, text doesn't overflow
  </verify>
  <done>Leaderboard page complete with period toggle, countdown, supportive messaging and pinned member row</done>
</task>

</tasks>

<verification>
1. Restart Express server (new route added)
2. Navigate to /dashboard/leaderboard
3. Toggle between "This Month" and "All Time" - data changes based on period
4. When viewing "This Month": countdown timer shows days/hours until reset
5. Your rank card shows with supportive message
6. Top 25 members display in table
7. If you're outside top 25: your row appears pinned below
8. "How to Earn Gold" shows point actions
9. Network tab: /api/leaderboard?period=month called, refetches every 5 min
10. Mobile test: Resize browser to 375px width
    - Period tabs stack or remain usable
    - Rank card stacks vertically
    - Table remains readable with horizontal scroll if needed
    - "How to Earn" cards stack to single column
</verification>

<success_criteria>
- UI-06: Leaderboard page showing rankings
- UI-11: Mobile responsive - verified at 375px breakpoint
- GAME-09: Top 25 members ranked by total points
- GAME-10: Current member rank shown even if outside top 25
- GAME-11: Members with leaderboardVisible=false excluded from rankings
- GAME-12: Monthly/All-time toggle with countdown timer to reset
- GAME-13: Current streak shown in leaderboard
- JOBS-03: 5-minute refresh via React Query (client-side)
</success_criteria>

<output>
After completion, create `.planning/phases/32-member-dashboard-pages/32-05-SUMMARY.md`
</output>
