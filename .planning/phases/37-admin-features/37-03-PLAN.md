---
phase: 37-admin-features
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - dashboard/src/app/admin/analytics/page.tsx
autonomous: true

must_haves:
  truths:
    - "Analytics page shows current period data without comparison percentages"
    - "Date range presets (7d, 30d, 90d) are easily accessible"
    - "Export buttons work correctly"
  artifacts:
    - path: "dashboard/src/app/admin/analytics/page.tsx"
      provides: "Simplified analytics dashboard without comparison display"
      min_lines: 300
  key_links:
    - from: "dashboard/src/app/admin/analytics/page.tsx"
      to: "adminAnalyticsApi.exportCsv/exportJson"
      via: "window.open for downloads"
      pattern: "window\\.open"
---

<objective>
Simplify the Analytics Dashboard by removing comparison display per user decision.

Purpose: Per CONTEXT.md decision "No comparison to previous period - just show current period data", the comparison metrics should be hidden. The page is nearly complete - this is a minor adjustment.

Output: Updated analytics/page.tsx without period comparison display, with working exports.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/37-admin-features/37-CONTEXT.md
@.planning/phases/37-admin-features/37-RESEARCH.md
@dashboard/src/app/admin/analytics/page.tsx
@dashboard/src/hooks/useAnalytics.ts
@dashboard/src/lib/admin-api.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove Comparison Display</name>
  <files>dashboard/src/app/admin/analytics/page.tsx</files>
  <action>
Remove the period comparison functionality:

1. Remove the useEngagementComparison import and hook call:
   - Delete: `const { data: comparison } = useEngagementComparison(dateRange.start, dateRange.end);`

2. Update Overview tab KPI cards:
   - Remove `change={comparison?.change.total}` prop from Active Members card
   - Keep all cards, just remove the change prop

3. Update Engagement tab:
   - Remove the entire "Period Comparison" section (the grid of 4 KpiCards with change props)
   - This is around lines 263-286 in current implementation
   - Keep the engagement chart above it

4. Verify export buttons work:
   - Check that adminAnalyticsApi.exportCsv() returns correct URL
   - Check that adminAnalyticsApi.exportJson() returns correct URL
   - Both should include auth token in URL or header
   - If exports don't work, check admin-api.ts for token handling

5. Add quick date preset buttons if not prominent:
   - The DateRangePicker component already has presets (7d, 30d, 90d)
   - If presets aren't visible enough, add explicit buttons above the picker:
     ```tsx
     <div className="flex gap-2 mb-4">
       <Button size="sm" variant="outline" onClick={() => setDateRange({ start: last7d, end: today })}>
         7 days
       </Button>
       <Button size="sm" variant="outline" onClick={() => setDateRange({ start: last30d, end: today })}>
         30 days
       </Button>
       <Button size="sm" variant="outline" onClick={() => setDateRange({ start: last90d, end: today })}>
         90 days
       </Button>
     </div>
     ```
   - Only add if DateRangePicker presets are hard to find

6. Keep all other functionality intact:
   - Overview, Members, Engagement, Benchmarks, Resources tabs
   - All charts and tables
   - At-risk members list
   - Cohort retention heatmap
  </action>
  <verify>
Run `npm run build --prefix dashboard` - should compile without errors.
Visit /admin/analytics - should load without comparison data.
Check Engagement tab - no comparison cards should appear.
Click CSV export - should download or open file.
Click JSON export - should download or open file.
  </verify>
  <done>
Analytics page displays without period comparison, exports work, date presets accessible.
  </done>
</task>

</tasks>

<verification>
1. Overview tab loads with KPI cards (no comparison arrows/percentages)
2. Engagement tab shows chart without comparison section below
3. CSV export button triggers download
4. JSON export button triggers download
5. Date range presets are easy to use
6. All tabs still function correctly
7. No console errors
</verification>

<success_criteria>
- No comparison data displayed anywhere
- useEngagementComparison hook removed from page
- Export buttons functional
- Date range selection works with presets
- All existing functionality preserved (tabs, charts, tables)
</success_criteria>

<output>
After completion, create `.planning/phases/37-admin-features/37-03-SUMMARY.md`
</output>
